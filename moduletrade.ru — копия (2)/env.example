cat > .env << 'EOF'
# ==============================================
# MODULETRADE - PRODUCTION ENVIRONMENT
# ==============================================

NODE_ENV=production

# ==============================================
# SERVER
# ==============================================
PORT=3000
HOST=0.0.0.0
LOG_LEVEL=info
LOG_FORMAT=combined
UPLOAD_DIR=./uploads
MAX_FILE_SIZE=50mb

# ==============================================
# DATABASE (PostgreSQL)
# ==============================================
DB_HOST=postgres
DB_PORT=5432
DB_NAME=saas_platform
DB_USER=postgres
DB_PASSWORD=594YqJoG2Vo0u6bYry732oZ_Q

# Для init контейнера Postgres (как в compose)
POSTGRES_DB=saas_platform
POSTGRES_USER=postgres
POSTGRES_PASSWORD=594YqJoG2Vo0u6bYry732oZ_Q

# ==============================================
# REDIS
# ==============================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=d-g-6u--aD-kGQGbm3LRaKOBp
REDIS_URL=redis://:d-g-6u--aD-kGQGbm3LRaKOBp@redis:6379

# ==============================================
# RABBITMQ
# ==============================================
RABBITMQ_HOST=rabbitmq
RABBITMQ_PORT=5672
RABBITMQ_USER=moduletrade_admin
RABBITMQ_PASS=3mVVdqZ9EcyrpQSCS-c44r7yV
# ВАЖНО: без слеша. Бэкенд сам добавит "/"
RABBITMQ_VHOST=moduletrade
RABBITMQ_URL=amqp://moduletrade_admin:3mVVdqZ9EcyrpQSCS-c44r7yV@rabbitmq:5672/moduletrade

# ==============================================
# JWT TOKENS
# ==============================================
JWT_SECRET=VerySecureJWTSecretKeyForModuleTradeProject2025MinimumLength32Characters
JWT_REFRESH_SECRET=AnotherSecureJWTRefreshKeyForModuleTradeProject2025DifferentFromMain

# ==============================================
# URLS (same-origin)
# ==============================================
SITE_BASE_URL=https://moduletrade.ru
FRONTEND_URL=https://moduletrade.ru
# Для фронта оставляем пустыми, чтобы брались из текущего origin
API_URL=
BACKEND_URL=
REACT_APP_API_URL=
REACT_APP_WS_URL=

# ==============================================
# SECURITY
# ==============================================
ENCRYPTION_KEY=ChangeThisToAStrongLongSecretKeyForProd_2025_AtLeast32Chars
CORS_ORIGIN=https://moduletrade.ru,https://www.moduletrade.ru
SESSION_SECRET=ModuleTradeSecureSessionSecret2025MinimumLength32Chars

# Регистрация (включена для проверки — потом выключить)
ALLOW_REGISTRATION=true
# Можно ограничить IP (через запятую): 1.2.3.4,5.6.7.8
ALLOWED_REGISTER_IPS=

# ==============================================
# JOBS / MIGRATIONS
# ==============================================
RUN_MIGRATIONS_ON_START=false
START_JOBS_ON_START=true

# ==============================================
# EMAIL (опционально)
# ==============================================
MAIL_HOST=smtp.gmail.com
MAIL_PORT=587
MAIL_USER=noreply@moduletrade.ru
MAIL_PASS=your_gmail_app_password
MAIL_FROM=noreply@moduletrade.ru

# ==============================================
# RATE LIMITING / CACHE / UPLOADS
# ==============================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_WINDOW_MS=900000

UPLOAD_ENABLED=true
UPLOAD_MAX_FILES=10
ALLOWED_FILE_TYPES=xlsx,csv,json,png,jpg,jpeg

CACHE_ENABLED=true
CACHE_TTL=300

# ==============================================
# SSL/TLS (для nginx)
# ==============================================
SSL_ENABLED=true
SSL_REDIRECT=true
EOF